<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Login con Google (popup)</title>
</head>
<body>
  <h1>Login con Google (popup)</h1>
  <button onclick="loginGoogle()">Iniciar sesi√≥n</button>

  <pre id="output"></pre>

  <script>
    const CLIENT_ID = "569265039972-tpllhdeddojvqh22j22cl9is8gvrp2h2.apps.googleusercontent.com";
    const REDIRECT_URI = "http://localhost:8000/callback.html"; // tu redirect real

    function loginGoogle() {
      const url =
        "https://accounts.google.com/o/oauth2/v2/auth" +
        "?client_id=" + CLIENT_ID +
        "&redirect_uri=" + encodeURIComponent(REDIRECT_URI) +
        "&response_type=token" +           // devuelve directamente access_token en el hash
        "&scope=openid%20email%20profile" +
        "&prompt=select_account";

      const w = 500, h = 600;
      const left = (screen.width - w) / 2;
      const top = (screen.height - h) / 2;

      const popup = window.open(
        url,
        "googleLogin",
        `width=${w},height=${h},top=${top},left=${left}`
      );

      // Escuchar mensajes desde el popup
      window.addEventListener("message", (event) => {
        if (event.origin !== window.location.origin) return;
        if (event.data.type === "google_token") {
          document.getElementById("output").textContent =
            "Access Token:\n" + event.data.token;
        }
      });
    }
  </script>
</body>
</html>
